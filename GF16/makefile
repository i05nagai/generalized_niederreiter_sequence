.SUFFIXES:
.SUFFIXES: .o .c

CC = gcc

.c.o : 
	$(CC) -c $<

### SOURCES ###
EXAMPLE_SOURCES = example.c

GF16_SOURCES = GF16.c
GF16_SOURCES += GF16_matrix.c
GF16_SOURCES += GF16X.c
GF16_SOURCES += GF16_scramble.c

N_LDS_GF16_SOURCES = LDS_GF16.c
N_LDS_GF16_SOURCES += GF16_niederriter.c
N_LDS_GF16_SOURCES += GF16_gc_niederriter.c
N_LDS_GF16_SOURCES += GF16_gc2_niederriter.c
N_LDS_GF16_SOURCES += LDS_Gauss_GF16.c
N_LDS_GF16_SOURCES += GF16_matrix_gen.c
N_LDS_GF16_SOURCES += GaussDevBM.c

GF16_TABLE_GENERATOR_SOURCES = GF16_table_generator.c
GF16_GEN_IRRED_POLY_SOURCES = GF16_gen_irred_poly.c

### OBJCTS ###
EXAMPLE_OBJS = ${EXAMPLE_SOURCES:.c=.o}
GF16_OBJS = ${GF16_SOURCES:.c=.o}
N_LDS_GF16_OBJS = ${N_LDS_GF16_SOURCES:.c=.o}
GF16_TABLE_GENERATOR_OBJS = ${GF16_TABLE_GENERATOR_SOURCES:.c=.o}
GF16_GEN_IRRED_POLY_OBJS = ${GF16_GEN_IRRED_POLY_SOURCES:.c=.o}

### LIST ###
EXAMPLE_LIST = ${EXAMPLE_SOURCES:.c=.u}
GF16_LIST = ${GF16_SOURCES:.c=.u}
N_LDS_GF16_LIST = ${N_LDS_GF16_SOURCES:.c=.u}
GF16_TABLE_GENERATOR_LIST = ${GF16_TABLE_GENERATOR_SOURCES:.c=.u}
GF16_GEN_IRRED_POLY_LIST = ${GF16_GEN_IRRED_POLY_SOURCES:.c=.u}

### STRINGS ###
GF16 = GF16
N_LDS_GF16 = n_lds_GF16

### DIRECTORYS ###
LIBDIR = -I/usr/local/include
LIBDIR += -I/usr/include
#LIBDIR += -I./
LIBDIR += -L/usr/local/lib
LIBDIR += -L/usr/lib
#LIBDIR += -L./

### LIBRARYS ###
LIBFLAGS = $(LIBDIR)
#LIBFLAGS += -l$(N_LDS_GF16) -l$(GF16)
LIBFLAGS += -lgsl -lgslcblas -lm

### EXECUTABLE FILE NAMES ###
EXAMPLE = example
GF16_TABLE_GENERATOR = GF16_table_generator
GF16_GEN_IRRED_POLY = GF16_gen_irred_poly

### TARGET LIBRARYS ###
TARGET_GF16 = lib$(GF16).a
TARGET_N_LDS_GF16 = lib$(N_LDS_GF16).a

TARGETS = $(TARGET_GF16)
TARGETS += $(TARGET_N_LDS_GF16)

### MAKE ###
all : $(EXAMPLE) $(TARGETS) $(GF16_TABLE_GENERATOR) $(GF16_GEN_IRRED_POLY)

$(EXAMPLE) : $(EXAMPLE_OBJS) $(TARGET_N_LDS_GF16) $(TARGET_GF16)
	$(CC) -o $@ $^ $(LIBFLAGS)

$(TARGET_GF16) : $(GF16_OBJS)
	rm -f $(TARGET_GF16)
	ar cvr $(TARGET_GF16) $(GF16_OBJS)

$(TARGET_N_LDS_GF16) : $(N_LDS_GF16_OBJS)
	rm -f $(TARGET_N_LDS_GF16)
	ar cvr $(TARGET_N_LDS_GF16) $(N_LDS_GF16_OBJS)

$(GF16_TABLE_GENERATOR) : $(GF16_TABLE_GENERATOR_OBJS)
	$(CC) -o $@ $^ $(LIBFLAGS)

$(GF16_GEN_IRRED_POLY) : $(GF16_GEN_IRRED_POLY_OBJS) $(TARGET_GF16)
	$(CC) -o $@ $^ $(LIBFLAGS)
